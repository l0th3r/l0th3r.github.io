var R=Object.defineProperty;var A=(t,e,n)=>e in t?R(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var u=(t,e,n)=>(A(t,typeof e!="symbol"?e+"":e,n),n);import{S as W,P as C,R as q,A as _,W as U,O as T,G as N,T as I,M as y,a as L,b as j,V as $,c as F,d as z}from"./vendor.8163a7c8.js";const J=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}};J();var m={};const O={MakeReq:function(t,e,n,i){var o=new XMLHttpRequest;o.onreadystatechange=function(){if(this.readyState===4&&this.status===200){var s=JSON.parse(this.response);e&&e(this.status,s)}else this.readyState!=4?n&&n(this.readyState):i&&i(this.status)},o.open("GET",t,!0),o.send()},FormatRequestAndSend:function(t=[],e=[]){var n="https://api.le-systeme-solaire.net/rest/bodies?";return t.forEach(i=>{n+=`filter[]=${i}&`}),e.length>0&&(n+="data="),e.forEach(i=>{n+=`${i},`}),n.slice(0,-1)},GetJsonFile:function(t,e,n,i){this.MakeReq(t,(o,s)=>{m.settings=s,e()},n,i)},GetPlanets:function(t,e,n){const i=this.FormatRequestAndSend(["isPlanet,neq,false","id,neq,ceres","id,neq,eris","id,neq,haumea","id,neq,makemake"],["id","englishName","vol","equaRadius","sideralRotation","discoveredBy","rel"]);this.MakeReq(i,(o,s)=>{m.planets=s.bodies,t(s.bodies)},e,n)}};var d={allowHover:!0,scene:new W,camera:new C(75,window.innerWidth/window.innerHeight,.1,1500),raycaster:new q,mouse:{x:0,y:0},canvas:document.querySelector("#env"),lights:{ambientLight:new _(16777215)},Init:function(){this.renderer=new U({canvas:this.canvas,alpha:!0}),this.camera.position.set(600,600,0),this.camera.rotation.set(10,0,0),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(window.innerWidth,window.innerHeight),this.controls=new T(this.camera,this.renderer.domElement),this.scene.add(this.lights.ambientLight),this.ChangeBG("/textures/stars.jpg")},Debug:function(){const t=new N(1e3,100);this.scene.add(t),window.addEventListener("click",()=>{console.log(this.camera.position),console.log(this.camera.rotation)})},ChangeBG:function(t){this.canvas.style.background=`url(${t}) no-repeat center center`},Render:function(){this.renderer.render(this.scene,this.camera)},Click:function(){this.hoveredObject&&this.hoveredObject.Interact(this.hoveredObject)},hoveredObject:void 0,HoverObjects:function(){if(this.allowHover===!0){this.raycaster.setFromCamera(this.mouse,this.camera);const t=this.raycaster.intersectObjects(this.scene.children);t.length>0?t[0].object.data.type==="_Interactible"&&t[0].object.data.parent!=this.hoveredObject&&(this.hoveredObject=t[0].object.data.parent,this.hoveredObject.allowInteraction===!0&&(this.hoveredObject.Hover(this.hoveredObject),document.body.style.cursor="pointer")):(this.hoveredObject&&(this.hoveredObject.UnHover(this.hoveredObject),this.hoveredObject=void 0),document.body.style.cursor="default")}}},r=void 0;class V{constructor(e=0){u(this,"money");u(this,"planets");this.money=e,this.planets=[]}AddPlanetData(e){this.planets.push(e)}GetPlanetData(e){return this.planets.filter(n=>n.data.id===e)[0]}UpdatePlanetData(e,n){this.GetPlanetData(e).InjectData(n),k()}ModMoney(e){this.money+=e,k()}}class w{constructor(e={}){u(this,"data",{id:"null",lvl:1,stock:0,stockLvl:1,ressourceName:"Carbon",miningProgression:-1});this.InjectData(e)}InjectData(e={}){this.data=Object.assign(this.data,e)}}function X(){r=new V(10),r.AddPlanetData(new w({id:"Jupiter",lvl:1,stock:0,stockLvl:2,ressourceName:"Carbon"})),r.AddPlanetData(new w({id:"Venus"})),r.AddPlanetData(new w({id:"Earth"}))}const a={};a.planetWin=document.getElementById("ui-planet-win");a.isPlanetWinOpen=!1;a.mineBtn=document.getElementById("btn-mine");a.sellStockBtn=document.getElementById("btn-sell-stock");a.upgradeStock=document.getElementById("btn-upgrade-stock");a.mineBtn.addEventListener("click",()=>Q(a.mineBtn.value));a.sellStockBtn.addEventListener("click",()=>Y(a.mineBtn.value));a.upgradeStock.addEventListener("click",()=>K(a.mineBtn.value));document.getElementById("ui-planet-win-close").addEventListener("click",Z);function K(t){const e=r.GetPlanetData(t).data;r.money>=(e.stockLvl+1)*10?(r.ModMoney(-(e.stockLvl+1)*10),r.GetPlanetData(t).data.stockLvl+=1):console.log("fuck off"),b(t,!1)}function Y(t){const e=r.GetPlanetData(t).data,n=m.settings.ressources.filter(i=>i.name===e.ressourceName)[0];r.ModMoney(e.stock*(n.unit_value+1)),r.GetPlanetData(t).data.stock=0,b(t,!1)}function Q(t){const e=r.GetPlanetData(t).data;e.stock<e.stockLvl*10&&(r.GetPlanetData(t).data.stock+=1,b(t,!1))}function b(t,e=!0){const n=r.GetPlanetData(t).data,i=m.settings.ressources.filter(s=>s.name===n.ressourceName)[0];var o=n.stock*(i.unit_value+1);a.mineBtn.value=n.id,l("ui-planet-name",n.id),l("ui-ressource-name",n.ressourceName),l("ui-stock",n.stock),l("ui-max-stock",n.stockLvl*10),l("ui-next-stock-upgrade",n.stock),l("ui-mining-value",n.lvl),l("ui-stock-value",o),l("ui-next-stock-upgrade",n.stockLvl+1),l("ui-next-stock-upgrade-price",(n.stockLvl+1)*10),n.stock>=n.stockLvl*10?a.mineBtn.setAttribute("disabled","true"):a.mineBtn.removeAttribute("disabled"),n.stock<=0?a.sellStockBtn.setAttribute("disabled","true"):a.sellStockBtn.removeAttribute("disabled"),a.isPlanetWinOpen===!1&&e===!0&&ee()}function l(t,e){var n=document.getElementsByClassName(t);for(let i of n)i.innerHTML=e}function Z(){a.planetWin.style.display="none",a.isPlanetWinOpen=!1}function ee(){a.planetWin.style.display="block",a.isPlanetWinOpen=!0}function te(){ne()}function ne(){var t=document.getElementById("ui-header");t&&t.remove();var e=document.createElement("div");e.id="ui-header",e.classList.add("ui-container","ui-element","ui-align","ui-panel","ui-padding","ui-right","ui-border-bot");var n=document.createElement("span");n.classList.add("ui-data"),n.innerHTML='Money: <span id="ui-money" class="ui-data">0</span>$',e.appendChild(n),document.body.appendChild(e),a.money={},a.money.window=e,a.money.ui=document.getElementById("ui-money"),k()}function k(){a.money.ui.innerHTML=r.money}var M=[];function ie(){const t=new I().load("/textures/planets/sun.jpg"),e=new y(new L(60,32,32),new j({map:t})),n=new S(d.scene,"sun",e,0,0,0,!0);n.allowRotation=!1,n.allowMovements=!1,n.allowInteraction=!1,m.planets.forEach((i,o)=>{const s=new I().load(`/textures/planets/${i.id}.jpg`),c=oe(i.equaRadius,1188.3,71492,12,20),h=new y(new L(c,32,32),new j({map:s}));new S(d.scene,i.englishName,h,o*35+150,E(.01,.05),E(.01,.028),!0,{type:"_Interactible"},void 0,void 0,f=>b(f.id))})}function oe(t,e,n,i,o){var s=t-e,c=n-e,h=s/c,f=o-i,v=f*h,g=v+i;return g}function E(t,e){return Math.random()*(e-t)+t}class S{constructor(e,n,i,o,s,c,h=!0,f={},v=this.Default_Hover,g=this.Default_UnHover,x=this.Default_Interact,H=!1,G=void 0){u(this,"allowMovements",!0);u(this,"allowInteraction",!0);u(this,"allowRotation",!0);u(this,"orbitInfo",{orbitRadius:0,rotSpeed:0,rot:0,orbitSpeed:0,orbit:0,rotSpeed:0,origin:new $(0,0,0)});this.id=n,this.object=i,this.object.data=f,this.object.data.parent=this,this.object.position.set(o,0,0),this.Hover=v,this.UnHover=g,this.Interact=x,this.orbitInfo.orbitRadius=o,this.orbitInfo.rotSpeed=.005+s*.1,this.orbitInfo.rot=Math.random(),this.orbitInfo.orbitSpeed=(.01-c*100*.0048)*.25,this.orbitInfo.orbit=Math.random()*Math.PI*2,this.orbitInfo.rotSpeed*=1,h===!0&&(this.orbitLine=new y(new F(o,.5,10,100),new z({color:16777215,transparent:!0,opacity:.15})),this.orbitLine.rotation.set(1.5708,0,0),this.orbitLine.position.set(this.orbitInfo.origin.x,this.orbitInfo.origin.y,this.orbitInfo.origin.z),this.orbitLine.data={type:"_OrbitLine"},e.add(this.orbitLine)),this.hasOrbitLine=h,H===!0&&this.LinkOrbit(G),M.push(this),e.add(this.object),this.SetOrbitOrigin(0,0,0)}Update(){this.isLinked===!0&&this.SetOrbitOrigin(this.linked.object.position.x,this.linked.object.position.y,this.linked.object.position.z),this.allowRotation===!0&&(this.orbitInfo.rot+=this.orbitInfo.rotSpeed,this.object.rotation.set(0,this.orbitInfo.rot,0)),this.allowMovements===!0&&(this.orbitInfo.orbit+=this.orbitInfo.orbitSpeed,this.object.position.set(Math.cos(this.orbitInfo.orbit)*this.orbitInfo.orbitRadius+this.orbitInfo.origin.x,this.orbitInfo.origin.y,Math.sin(this.orbitInfo.orbit)*this.orbitInfo.orbitRadius+this.orbitInfo.origin.z))}LinkOrbit(e){this.isLinked=!0,this.linked=e}SetOrbitOrigin(e,n,i){this.orbitInfo.origin.x=e,this.orbitInfo.origin.y=n,this.orbitInfo.origin.z=i,this.hasOrbitLine===!0&&this.orbitLine.position.set(e,n,i)}GetOrbitOrigin(){return this.orbitInfo.origin}Default_Hover(e){}Default_UnHover(){}Default_Interact(){}}X();O.GetPlanets(se,ae,P);function se(t){O.GetJsonFile("/assets/settings.json",re,()=>{},P)}function ae(t){document.getElementById("progress").style.width=`${t*100/4}%`,document.getElementById("loading-txt").innerText=`Loading ${t*100/4}%`}function P(t){document.getElementById("progress").style.width="100%",document.getElementById("loading-txt").innerText="Error: "+t}function re(){setTimeout(function(){document.getElementById("progress").style.width="100%",document.getElementById("loading-txt").innerText="Loading 100%",setTimeout(function(){document.getElementById("loading-env").style.display="none",te(),ie(),d.Init(),D()},800)},1200)}function D(){requestAnimationFrame(D),M.forEach(t=>{t.Update()}),d.Render()}window.addEventListener("resize",de,!1);function de(){d.renderer&&(d.camera.aspect=window.innerWidth/window.innerHeight,d.camera.updateProjectionMatrix(),d.renderer.setSize(window.innerWidth,window.innerHeight))}const B=document.getElementById("env");var p={isMouseInCanvas:!1};function ce(t){p.isMouseInCanvas===!0&&(d.mouse.x=t.clientX/window.innerWidth*2-1,d.mouse.y=-(t.clientY/window.innerHeight)*2+1,d.HoverObjects())}function le(t){p.isMouseInCanvas===!0&&d.Click()}B.addEventListener("mouseleave",()=>{p.isMouseInCanvas=!1,document.body.style.cursor="default"});B.addEventListener("mouseenter",()=>p.isMouseInCanvas=!0);window.addEventListener("mousemove",ce,!1);window.addEventListener("click",le,!1);
