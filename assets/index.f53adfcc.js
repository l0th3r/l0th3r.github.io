var A=Object.defineProperty;var T=(e,i,t)=>i in e?A(e,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[i]=t;var f=(e,i,t)=>(T(e,typeof i!="symbol"?i+"":i,t),t);import{T as I,M as v,S as k,a as L,V as S,b as q,c as C,d as N,P as D,A as G,W as U,O as _,G as F}from"./vendor.09f12756.js";const z=function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(n){if(n.ep)return;n.ep=!0;const o=t(n);fetch(n.href,o)}};z();var m={};const $={MakeReq:function(e,i,t,s){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(this.readyState===4&&this.status===200){var o=JSON.parse(this.response);i&&i(this.status,o)}else this.readyState!=4?t&&t(this.readyState):s&&s(this.status)},n.open("GET",e,!0),n.send()},FormatRequestAndSend:function(e=[],i=[]){var t="https://api.le-systeme-solaire.net/rest/bodies?";return e.forEach(s=>{t+=`filter[]=${s}&`}),i.length>0&&(t+="data="),i.forEach(s=>{t+=`${s},`}),t.slice(0,-1)},GetJsonFile:function(e,i,t,s){this.MakeReq(e,(n,o)=>{m.settings=o,i()},t,s)},GetPlanets:function(e,i,t){const s=o=>{const a=o.sort((c,u)=>c.aphelion-u.aphelion);m.planets=a,e(a)},n=this.FormatRequestAndSend(["isPlanet,neq,false","id,neq,ceres","id,neq,eris","id,neq,haumea","id,neq,makemake","id,neq,pluton"],["id","englishName","vol","equaRadius","sideralRotation","discoveredBy","rel","aphelion"]);this.MakeReq(n,(o,a)=>{s(a.bodies)},i,t)}},O=document.getElementById("file-input");O.onchange=()=>{const e=O.files[0];var i=new FileReader;i.readAsText(e,"UTF-8"),i.onload=function(t){J(t.target.result)}};var h=void 0;function M(e=!1){window.localStorage.setItem("GravityClicker",JSON.stringify(h)),e===!0&&alert("Your data are saved in your browser's files :)")}function J(e){const i=JSON.parse(atob(e));var t;try{t=JSON.parse(response)}catch(s){}h=i,M(!0),location.reload()}const r={};document.getElementById("ui-planet-win-close").addEventListener("click",V);function X(e,i=!0){const t=h.GetPlanetData(e).data,s=m.settings.ressources.filter(o=>o.name===t.ressourceName)[0];var n=t.stock*(s.unit_value+1);r.planetWinId=e,r.mineBtn.value=t.id,r.planetWinProgressBar.classList="",r.planetWinProgressBar.classList.add("progress-planet",`ui-${e}-progress`),r.planetWinProgressBar.style.width=`${t.miningProgression+1}%`,l("ui-planet-name",t.id),l("ui-ressource-name",t.ressourceName),l("ui-stock",t.stock),l("ui-max-stock",t.stockLvl*10),l("ui-next-stock-upgrade",t.stock),l("ui-mining-value",t.lvl),l("ui-stock-value",n),l("ui-next-stock-upgrade",t.stockLvl+1),l("ui-next-stock-upgrade-price",(t.stockLvl+1)*10),t.stock>=t.stockLvl*10?r.mineBtn.setAttribute("disabled","true"):r.mineBtn.removeAttribute("disabled"),t.stock<=0?r.sellStockBtn.setAttribute("disabled","true"):r.sellStockBtn.removeAttribute("disabled"),h.money>=(t.stockLvl+1)*10?r.upgradeStock.removeAttribute("disabled"):r.upgradeStock.setAttribute("disabled","true"),r.isPlanetWinOpen===!1&&i===!0&&Y()}function l(e,i){var t=document.getElementsByClassName(e);for(let s of t)s.innerHTML=i}function V(){x(),d.UnfocusObject(),r.isPlanetWinOpen=!1}function Y(){Z(r.planetWin),r.isPlanetWinOpen=!0}function x(){r.displayedWindow&&(r.displayedWindow.style.display="none")}function Z(e){x(),r.displayedWindow=e,r.displayedWindow.style.display="block"}var w=document.getElementsByClassName("ui-nav-btn");for(let e of w)e.addEventListener("mouseenter",()=>{e.childNodes[3].style.display="block"});w=document.getElementsByClassName("ui-nav-btn");for(let e of w)e.addEventListener("mouseleave",()=>{e.childNodes[3].style.display="none"});window.onbeforeunload=function(e){h.requestWipe||M()};var y=[];function K(){const e=new I().load("/textures/planets/sun.jpg"),i=new v(new k(60,32,32),new L({map:e})),t=new j(d.scene,"sun",i,0,0,0,!0);t.allowRotation=!1,t.allowMovements=!1,t.allowInteraction=!1,m.planets.forEach((s,n)=>{const o=new I().load(`/textures/planets/${s.id}.jpg`),a=Q(s.equaRadius,1188.3,71492,12,20),c=new v(new k(a,32,32),new L({map:o}));new j(d.scene,s.englishName,c,n*35+150,E(.01,.05),E(.01,.028),!0,{type:"_Interactible"},void 0,void 0,u=>{X(u.id),d.FocusObject(u.id)})})}function Q(e,i,t,s,n){var o=e-i,a=t-i,c=o/a,u=n-s,b=u*c,g=b+s;return g}function E(e,i){return Math.random()*(i-e)+e}class j{constructor(i,t,s,n,o,a,c=!0,u={},b=this.Default_Hover,g=this.Default_UnHover,W=this.Default_Interact,R=!1,H=void 0){f(this,"allowMovements",!0);f(this,"allowInteraction",!0);f(this,"allowRotation",!0);f(this,"orbitInfo",{orbitRadius:0,rotSpeed:0,rot:0,orbitSpeed:0,orbit:0,rotSpeed:0,origin:new S(0,0,0)});this.id=t,this.object=s,this.object.data=u,this.object.data.parent=this,this.object.position.set(n,0,0),this.Hover=b,this.UnHover=g,this.Interact=W,this.orbitInfo.orbitRadius=n,this.orbitInfo.rotSpeed=.005+o*.1,this.orbitInfo.rot=Math.random(),this.orbitInfo.orbitSpeed=(.01-a*100*.0048)*.25,this.orbitInfo.orbit=Math.random()*Math.PI*2,this.orbitInfo.rotSpeed*=1,c===!0&&(this.orbitLine=new v(new q(n,.5,10,100),new C({color:16777215,transparent:!0,opacity:.15})),this.orbitLine.rotation.set(1.5708,0,0),this.orbitLine.position.set(this.orbitInfo.origin.x,this.orbitInfo.origin.y,this.orbitInfo.origin.z),this.orbitLine.data={type:"_OrbitLine"},i.add(this.orbitLine)),this.hasOrbitLine=c,R===!0&&this.LinkOrbit(H),y.push(this),i.add(this.object),this.SetOrbitOrigin(0,0,0)}Update(){this.isLinked===!0&&this.SetOrbitOrigin(this.linked.object.position.x,this.linked.object.position.y,this.linked.object.position.z),this.allowRotation===!0&&(this.orbitInfo.rot+=this.orbitInfo.rotSpeed,this.object.rotation.set(0,this.orbitInfo.rot,0)),this.allowMovements===!0&&(this.orbitInfo.orbit+=this.orbitInfo.orbitSpeed,this.object.position.set(Math.cos(this.orbitInfo.orbit)*this.orbitInfo.orbitRadius+this.orbitInfo.origin.x,this.orbitInfo.origin.y,Math.sin(this.orbitInfo.orbit)*this.orbitInfo.orbitRadius+this.orbitInfo.origin.z))}LinkOrbit(i){this.isLinked=!0,this.linked=i}SetOrbitOrigin(i,t,s){this.orbitInfo.origin.x=i,this.orbitInfo.origin.y=t,this.orbitInfo.origin.z=s,this.hasOrbitLine===!0&&this.orbitLine.position.set(i,t,s)}GetOrbitOrigin(){return this.orbitInfo.origin}Default_Hover(i){}Default_UnHover(){}Default_Interact(){}}var d={allowHover:!0,scene:new N,camera:new D(75,window.innerWidth/window.innerHeight,.1,1500),cameraTarget:void 0,mouse:{x:0,y:0},canvas:document.querySelector("#env"),lights:{ambientLight:new G(16777215)},Init:function(){this.renderer=new U({canvas:this.canvas,alpha:!0}),this.camera.position.set(600,600,0),this.camera.rotation.set(10,0,0),this.cameraBasePos=this.camera.position,this.cameraBaseRot=this.camera.rotation,this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(window.innerWidth,window.innerHeight),this.controls=new _(this.camera,this.renderer.domElement),this.scene.add(this.lights.ambientLight),this.ChangeBG("/textures/stars.jpg")},Update:function(){if(this.cameraTarget){const e=this.cameraTarget.object.position;this.camera.lookAt(e),e.z-30>this.camera.position.z&&this.camera.translateZ(-20),e.x-30>this.camera.position.x&&this.camera.translateX(-20),e.z-30<this.camera.position.z&&this.camera.translateZ(20),e.x-30<this.camera.position.x&&this.camera.translateX(20)}else this.camera.lookAt(new S(0,0,0))},Debug:function(){const e=new F(1e3,100);this.scene.add(e),window.addEventListener("click",()=>{console.log(this.camera.position),console.log(this.camera.rotation)})},ChangeBG:function(e){this.canvas.style.background=`url(${e}) no-repeat center center`},Render:function(){this.renderer.render(this.scene,this.camera)},Click:function(){this.hoveredObject&&this.hoveredObject.Interact(this.hoveredObject)},hoveredObject:void 0,HoverObjects:function(){},FocusObject:function(e){if(this.cameraTarget)this.UnfocusObject();else{const i=y.filter(t=>t.id===e)[0];i.allowMovements=!1,this.cameraTarget=i,this.camera.rotation.set(0,0,0)}},UnfocusObject:function(){this.cameraTarget.allowMovements=!0,this.cameraTarget=void 0,this.camera.position.set(600,600,0),this.camera.rotation.set(10,0,0)}};$.GetPlanets(ie,ee,te);function ee(e){document.getElementById("progress").style.width=`${e*100/4}%`,document.getElementById("loading-txt").innerText=`Loading ${e*100/4}%`}function te(e){document.getElementById("progress").style.width="100%",document.getElementById("loading-txt").innerText="Error: "+e}function ie(){setTimeout(function(){document.getElementById("progress").style.width="100%",document.getElementById("loading-txt").innerText="Loading 100%",setTimeout(function(){document.getElementById("loading-env").style.display="none",K(),d.Init(),B()},0)},0)}function B(){requestAnimationFrame(B),y.forEach(e=>{e.Update()}),d.Render()}window.addEventListener("resize",ne,!1);function ne(){d.renderer&&(d.camera.aspect=window.innerWidth/window.innerHeight,d.camera.updateProjectionMatrix(),d.renderer.setSize(window.innerWidth,window.innerHeight))}const P=document.getElementById("env");var p={isMouseInCanvas:!1};function se(e){p.isMouseInCanvas===!0&&(d.mouse.x=e.clientX/window.innerWidth*2-1,d.mouse.y=-(e.clientY/window.innerHeight)*2+1)}function oe(e){p.isMouseInCanvas===!0&&d.Click()}P.addEventListener("mouseleave",()=>{p.isMouseInCanvas=!1,document.body.style.cursor="default"});P.addEventListener("mouseenter",()=>p.isMouseInCanvas=!0);window.addEventListener("mousemove",se,!1);window.addEventListener("click",oe,!1);
